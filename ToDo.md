# SEO prioritization

- we must determine in which language a phrase is

- check if lujvo - show all jvotunba at top
  - then show decomposition
- check if it's a lojban phrase to more than 90% - show def of each word in same language with fallback to jbo and en
  - if lujvo - decomp it and show veljvocmi in place
  - search in muplis by similar words
- if such word is only in english/jbo - show it
- if not lojban

  - search in english part of muplis via embeddings

- if single word
  - search in same language, fallback to jbo/en
    - muplis if nothing found
  - in search+ search by embeddings in same language if available
  - always search in muplis, show first 10 in a concise tile = on click expand to phrases search
- phrases search always works by embeddings in english, lojban-decom-priority-method in lojban

- if is a potential lojban word but never found - show alert tile

- if fuhivla - search for its prefix if found

- if lujvo decomposition doesnt work simply show "nasezvafahi" message

# todo

- embedding script - simplify it
  - for nodejs
  - for worker search
- refactor rimni search
- delete from sance: cmevla, fuhivla with '
  - create a new aws account and regenerate from there
  - rr. is not nice
- clearly specify color palette:
  - color for links
  - color for panel
- check all TODO
- fa'orma'o must search for famyma'o too
  - check if its lojbo and lujvo, decompose every lujvo.
  - search by rafsi too
  - filter with those rafsi in order
  - put at top
- two renders of same word when switching between words
- the CLL in markdown
- loading issues
  - dont change lermo'a while loading
  - cannot change query word while still loading
  - skicu before loading - optimize app loading speed
- restore corpus-downloader
  - better dump compression https://github.com/Magnushhoie/weightless_NN_decompression/tree/main
  - add embeddings models to corpus downloader
  * pack it to a ci/cd app, run every week
  - muplis with sentence embeddings
    - embeddings pregeneration script for all muplis and english sentences into z
  - embeddings
    - add embeddings to muplis generation
    - add embeddings to normal dict generation
      - replace $$, {} to [UNK]
    - input -> to using embedding
    - comment out fasttext
    - (?) use sentence embeddings for fasttext
    - (?) new generator for fasttext without lz compression
    - preload embeddings unwrapped
    - preload embeddings
    - loading bar improve embeddings and initial preload messaging
  - package lojban-corpus-downloader
    - download uncll sentences db
    - whole CLL content
    - download DwE
    - download propbank
- versio.json is used to check which files from dumps need to be updated
- tcini.json is used to check which files from sutysisku need to be updated
  - the list is generated by iterating thru the built bundle directory
- huggingface lojban-tts stopped working
- restore socket.io
- bundle size & speed
  - remove second query when no results
- how to separate official prefer vs semantic scales
- not every tile should fire an update
  - separate tiles by size
- restore feedback
  - send to chat
- simplify sql query
  - merge with muplis
  - RAM search: or from similarity to encoding of input
    - vector search
      - load in ram
      - fetch by id from sql
      - sort accordingly
  - show muplis sentences from encoding of input
  - merge muplis results into english
    - we have phrases mode for english only
    - the second result are top 10 results from muplis. lazy loading
    - on click switch to phrases mode
- coi.js, Cache: files to cache
  - cross origin isolated is a must
    - implement reload

## test

- dont send results to console in prod mode
- if ctucku is last word then on new db load it flickers with every download step
  - disable arrows when loading?
- check resize window
- restore sihesle
- What This is a problem because it looks to me that it is saying that “fi’inai” means “welcome”.
- if opfs erased restore all previously downloaded langs and models
- update broken after dumps updated

```
OriginPrivateFileSystemVFS.js:126 Uncaught (in promise) TypeError: Cannot perform %TypedArray%.prototype.set on a detached ArrayBuffer
    at Uint8Array.set (<anonymous>)
    at eval (OriginPrivateFileSystemVFS.js:126:15)
```

- lojban parser
  - cicd: get camxes.js parser
  - rebuild
- click on clear causes eternal animation
- audio file generation script
  - add audio links
  - ci/cd should first download from vreji/polly in itself, otherwise from Amazon polly
- audio
  - merpe'ajitstic and other cmevla, porto
  - check stress in ckafre'ole
  - check kahezgana
  - for each word in it check localstorage
    - if not found download via fetch and store to localstorage
  - for all found words in localstorage
    - add them to storeRAM.
- xraste dictionary generator
- nofix: show language(?)+mode flags in history line
- add utco font
- fa'orma'o not decomposed, not shown famyma'o
- rotation animation on search
  - should gracefully stop rotating
- arrows not shown on load, have to scroll
- arrows should only show once in a def. check prulamdei, ctucku
- https://www.npmjs.com/package/brotli-unicode
- dasri - rework
  - mobile:
    search line
    buttons: language normal semsearch rimni selmaho
    comment: additional links in this.language
    comment: use regexp
    history:
  - desktop: search + buttons
- mobile view fixes
  - mobile only top bar not nice
  - check resize window handling
- better message for semantic/+/catni/rimni/fanva/selmaho search
- search too slow
- localize alert messages
- simple coi leads to two queries in db!
- selmaho search not working
- second precise result is always in lojban - only sql change
- tooltips for long words must show load line
- on language change load more dicts
- language not changed on click from desktop
- if url coincides with clicked tile then search doesnt happen
- restore desktop tiles
- semdistance not disappears
- arrows disable button not working
- add opfs - how to detect support?
- when switching from tankomo to ctucku even arrows flicker
- on word change it is reset too early
- from desktop to searching mode - what if empty search
- clear button not working

## other

- grpc
- move ssr-prerenderer to a npm package
- use renderer
- use github addresses in package.json
- beautify html files in dev mode
- templating
  - TODO: how to store config.json ?
  - for css files: use scss hardcoded variables
  - for js files import from json
